define(["dojo/io-query","dojo/promise/all","esriApplicationBase/ApplicationBase","esri/core/accessorSupport/decorators","esri/widgets/Widget","esri/widgets/support/widget","dojo/Deferred","esri/core/promiseUtils","esri/core/requireUtils"],function(e,t,r,n,i,o,s,a,l){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=7)}([function(e,t,r){"use strict";function n(e){return e.middlewares?s.apply(void 0,e.middlewares)(o)(e.reducers,e.parentWidget,e.initialState):o(e.reducers,e.parentWidget,e.initialState)}function i(e){var t=c(e,function(e){return"function"==typeof e});return function(e,r){return void 0===e&&(e={}),l(t,function(t,n){return t(e[n],r)})}}function o(e,t,r){var n;r&&(n=r);var i=[],o={parentWidget:t,dispatch:function(r){n=e(n,r),i.forEach(function(e){return e(n)}),t.scheduleRender()},subscribe:function(e){return i.push(e),function(){var t=i.indexOf(e);i.splice(t,1)}},getState:function(){return n}};return o.dispatch({type:"INITIALIZE"}),o}function s(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return function(r,n,i){var o=t(r,n,i),s=o.dispatch,l=[];return l=e.map(function(e){return e({getState:o.getState,dispatch:function(e){return s(e)}})}),s=a.apply(void 0,l)(o.dispatch),p({},o,{dispatch:s})}}}function a(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return e.reduceRight(function(e,t){return t(e)},t)}}function l(e,t){return Object.keys(e).reduce(function(r,n){return r[n]=t(e[n],n),r},{})}function c(e,t){return Object.keys(e).reduce(function(r,n){return t(e[n])&&(r[n]=e[n]),r},{})}var p=this&&this.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(t,"__esModule",{value:!0});var u=r(14),d=function(){function e(e){this.childComponents={},this.dirty=!0,this.store=e,this.props=e.getState(),this.tsx=this.tsx.bind(this),this.updateProps=this.updateProps.bind(this),e.subscribe(this.updateProps)}return e.prototype.tsx=function(e,t,r){if("string"==typeof e)return u.tsx.apply(this,arguments);if(t&&t.key){var i=this.childComponents[t.key];return i?(i.dirty&&(i.renderResult=i.render()),i.renderResult):(this.childComponents[t.key]=new e(t.store?n(p({},t.store,{parentWidget:this.store.parentWidget})):this.store,t.key),this.childComponents[t.key].renderResult=this.childComponents[t.key].render(),this.childComponents[t.key].renderResult)}throw new Error("Custom components must each have a unique key property.")},e.prototype.render=function(){},e.prototype.componentWillReceiveProps=function(e){},e.prototype.shouldComponentUpdate=function(e){return!0},e.prototype.setState=function(e){this.state=p({},this.state,e),this.store.parentWidget.scheduleRender()},e.prototype.dispatch=function(e){this.store.dispatch(e)},e.prototype.updateProps=function(e){this.componentWillReceiveProps(e),this.dirty=this.shouldComponentUpdate(e),this.props=e},e}();t.default=d,t.newStore=n,t.combineReducers=i,t.middlewares={thunk:function(e){return function(t){return function(r){return"function"==typeof r?r(e.dispatch,e.getState):t(r)}}},debug:function(e){return function(t){return function(r){console.log(r.type,r);var n=t(r);return console.log("next state",e.getState()),n}}},addListener:function(e){return function(t){return function(r){return function(n){var i=r(n);return e(n,t.getState()),i}}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(15);t.SAVE_APP_BASE_RESULT=n.SAVE_APP_BASE_RESULT,t.LOAD_APP_FAIL=n.LOAD_APP_FAIL,t.LOAD_APP_PROGRESS=n.LOAD_APP_PROGRESS,t.LOAD_APP_SUCCESS=n.LOAD_APP_SUCCESS,t.loadApplicationBase=n.loadApplicationBase;var i=r(17);t.UPDATE_ITEMS=i.UPDATE_ITEMS,t.FILTER_ITEMS=i.FILTER_ITEMS,t.filterItems=i.filterItems,t.updateItems=i.updateItems;var o=r(18);t.PUSH=o.PUSH,t.HASH_CHANGE=o.HASH_CHANGE,t.push=o.push,t.hashChange=o.hashChange},function(t,r){t.exports=e},function(e,t,r){"use strict";var n=this&&this.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(t,"__esModule",{value:!0});var i={"360 VR Experience":"file","App Builder Extension":"file",Application:"file","ArcGIS Pro Add In":"file","ArcGIS Pro Configuration":"file","ArcPad Package":"file","CAD Drawing":"file",CSV:"file","CSV Collection":"file","CityEngine Web Scene":"file","Code Sample":"file",Dashboard:"file","Desktop Add In":"file","Desktop Application":"file","Desktop Application Template":"file","Desktop Style":"file","Document Link":"file","Explorer Add In":"file","Explorer Layer":"file","Explorer Map":"file","Feature Collection":"file","Feature Service":"file","File Geodatabase":"file",GeoJson:"file","Geocoding Service":"file","Geodata Service":"file","Geometry Service":"file","Geoprocessing Package":"file","Geoprocessing Sample":"file","Geoprocessing Service":"file","Globe Document":"file","Globe Service":"file",Image:"file","Image Collection":"file","Image Service":"file","Insights Workbook":"file",KML:"file","KML Collection":"file",Layer:"file","Layer Package":"file",Layout:"file","Locator Package":"file","Map Document":"file","Map Package":"file","Map Service":"file","Map Template":"file","Microsoft Excel":"file","Microsoft Powerpoint":"file","Microsoft Word":"file","Mobile Application":"file","Mobile Basemap Package":"file","Mobile Map Package":"file","Network Analysis Service":"file","Operations Dashboard Add In":"file","Operations Dashboard Extension":"file",PDF:"file","Pro Map":"file","Project Package":"file","Project Template":"file","Published Map":"file","Raster function template":"file","Rule Package":"file","Scene Document":"file","Scene Package":"file","Scene Service":"file","Service Definition":"file",Shapefile:"file","Stream Service":"file","Task File":"file","Visio Document":"file",WFS:"file",WMS:"file",WMTS:"file","Windows Mobile Package":"file","Windows Viewer Add In":"file","Workflow Manager Service":"file","iWork Keynote":"file","iWork Numbers":"file","iWork Pages":"file"};t.default=n({},i,{"Web Map":"webmap","Web Mapping Application":"webapp","Web Scene":"webscene",Dashboard:"webapp"})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SHOW_IN_VIEWER="SHOW_IN_VIEWER",t.SHOW_FULLSCREEN="SHOW_FULLSCREEN",t.MOUSE_OVER="MOUSE_OVER",t.MOUSE_OUT="MOUSE_OUT",t.VIEWER_CHANGE="VIEWER_CHANGE",t.showInViewer=function(){return{type:t.SHOW_IN_VIEWER}},t.showFullscreen=function(){return{type:t.SHOW_FULLSCREEN}},t.mouseOver=function(){return{type:t.MOUSE_OVER}},t.mouseOut=function(){return{type:t.MOUSE_OUT}}},function(e,r){e.exports=t},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),o=r(27);t.reducers=o.reducers;var s=r(5),a=r(28),l=r(29),c={compassWidget:"esri/widgets/Compass",homeWidget:"esri/widgets/Home",legendWidget:"esri/widgets/Legend",locateWidget:"esri/widgets/Locate",searchWidget:"esri/widgets/Search"},p=function(e){function t(t){var r=e.call(this,t)||this;return r.state={status:"loading",loadText:"scripts"},r.loadScripts=r.loadScripts.bind(r),r.loadMap=r.loadMap.bind(r),r.loadWidgets=r.loadWidgets.bind(r),r.loadScripts.bind(r)(),r}return n(t,e),t.prototype.render=function(){var e=this.tsx;return"loaded"===this.state.status?e("div",null):"loading"===this.state.status?e("div",null,e("div",{class:"loader is-active padding-leader-3 padding-trailer-3 center-style"},e("div",{class:"loader-bars"}),e("div",{class:"loader-text"},this.props.i18n.viewLoading[this.state.loadText]))):e("div",null,e("h3",{class:"center-style"},this.props.i18n.viewLoading.failed))},t.prototype.loadScripts=function(){var e=this;l.when(window.require,[this.props.webModule,this.props.viewModule]).then(function(t){var r=t[0],n=t[1];e.setState({loadText:"map"}),e.loadMap(r,n)},function(t){e.setState({status:"failed"})})},t.prototype.loadMap=function(e,t){var r,n=this,i=new e({portalItem:{id:this.props.id}});i.load().then(function(){return n.setState({loadText:"basemap"}),i.basemap.load()}).then(function(){n.setState({loadText:"layers"});var e=i.allLayers,t=e.map(function(e){return e.load()});return s(t.toArray())}).then(function(e){return n.setState({loadText:"widgets"}),r=new t({container:n.props.containerId,map:i}),n.loadWidgets(r)}).then(function(){r.container=n.props.containerId,n.setState({status:"loaded"})}).otherwise(function(e){n.setState({status:"failed"})})},t.prototype.loadWidgets=function(e){var t=this,r={"bottom-left":!0,"bottom-right":!0,"top-left":!0,"top-right":!0},n=Object.keys(this.props.widgets).reduce(function(e,n,i){return r[t.props.widgets[n]]&&e.push({module:c[n],position:t.props.widgets[n]}),e},[]);return l.when(window.require,n.map(function(e){return e.module})).then(function(t){return t.forEach(function(t,r){var i=new t({view:e});if(i.activeLayerInfos)return void i.watch("activeLayerInfos.length",function(){e.ui.add(i,n[r].position)});e.ui.add(i,n[r].position)}),a.resolve()})},t}(i.default);t.default=p},function(e,t,r){e.exports=r(8)},function(e,t,r){"use strict";var n=r(9),i=r(10);e.exports=function(e,t,r){var o=new n({config:JSON.parse(e),settings:JSON.parse(t)});new i.default({boilerplate:o,i18n:r}).container="viewDiv"}},function(e,t){e.exports=r},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0});var o=r(11),s=r(12),a=r(13),l=r(41),c=r(0),p=c.middlewares.thunk,u=(c.middlewares.debug,function(e){function t(t){var r=e.call(this)||this;return r.minimalGallery=new a.default(c.newStore({reducers:a.reducers,parentWidget:r,initialState:{base:{applicationBase:t.boilerplate,applicationBaseResult:null,i18n:t.i18n,status:"loading",loadMessage:"init"}},middlewares:[p,l.router]})),l.startHistoryListener(r.minimalGallery.store),r}return n(t,e),t.prototype.render=function(){return this.minimalGallery.render()},t=i([o.subclass("esri.widgets.MinimalGallery")],t)}(o.declared(s)));t.default=u},function(e,t){e.exports=n},function(e,t){e.exports=i},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),o=r(1),s=r(19),a=r(20),l=r(24),c=r(33),p=r(34);t.reducers=p.reducers;var u=function(e){function t(t){var r=e.call(this,t)||this;return r.state={status:"loading",loadMessage:"init"},r.dispatch(o.loadApplicationBase()),r}return n(t,e),t.prototype.render=function(){var e=this.tsx,t=this.props.base.i18n,r=this.props.base.status;return"loading"===r?e("div",null,e("div",{class:"loader is-active padding-leader-3 padding-trailer-3 center-style",key:"loader"},e("div",{class:"loader-bars"}),e("div",{bind:this,class:"loader-text"},t.appLoading[this.state.loadMessage]))):"success"===r?e("div",null,e(s.default,{key:"minimal-gallery-header"}),e(a.default,{key:"minimal-gallery"}),e(l.default,{key:"minimal-gallery-viewer"}),e(c.default,{key:"minimal-gallery-pager"})):e("div",null,e("h3",{class:"center-style"},t.appLoading.failed))},t}(i.default);t.default=u},function(e,t){e.exports=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SAVE_APP_BASE_RESULT="SAVE_APP_BASE_RESULT",t.LOAD_APP_FAIL="LOAD_APP_FAIL",t.LOAD_APP_PROGRESS="LOAD_APP_PROGRESS",t.LOAD_APP_SUCCESS="LOAD_APP_FINISH";var n=r(5),i=r(16),o=r(1),s=r(3);t.loadApplicationBase=function(){return function(e,t){t().base.applicationBase.load().then(function(t){return e(a(t))},function(t){return e(p(t))},function(t){return e(u(t))})}};var a=function(e){return function(t,r){t(c(e));var i=r(),a=i.base.applicationBase,u=e.config;l(a,u).then(function(e){var r=e.results.map(function(e){return e.load()});n(r).then(function(e){i.router.hash;t(o.updateItems(e.filter(function(e){return s.default[e.type]}))),t(o.hashChange(window.location.hash.slice(1))),t(d())},function(e){return t(p(e))})},function(e){return t(p(e))})}},l=function(e,t){var r=new i;return e.queryGroupItems(t.group,{num:100,sortField:t.sortField?t.sortField:"numviews",sortOrder:t.sortOtder?t.sortOrder:"desc",start:0}).then(function(i){if(i.total>i.results.length){var o=Array.apply(null,{length:Math.floor(i.total/100)}),s=o.map(function(r,n){return e.queryGroupItems(t.group,{num:100,sortField:t.sortField?t.sortField:"numviews",sortOrder:t.sortOtder?t.sortOrder:"desc",start:100+100*n})});n(s).then(function(e){var t=e.reduce(function(e,t){return e.results=e.results.concat(t.results),e},{results:i.results});r.resolve(t)},function(e){r.reject(e)})}else r.resolve(i)},function(e){r.reject(e)}),r},c=function(e){return{type:t.SAVE_APP_BASE_RESULT,payload:e}},p=function(e){return{type:t.LOAD_APP_FAIL,payload:e}},u=function(e){return{type:t.LOAD_APP_PROGRESS,payload:e.status}},d=function(){return{type:t.LOAD_APP_SUCCESS}}},function(e,t){e.exports=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UPDATE_ITEMS="UPDATE_ITEMS",t.FILTER_ITEMS="FILTER_ITEMS",t.updateItems=function(e){return{type:t.UPDATE_ITEMS,payload:e}},t.filterItems=function(e){return{type:t.FILTER_ITEMS,payload:e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PUSH="ROUTER/PUSH",t.LOCATION_CHANGE="ROUTER/LOCATION_CHANGE",t.HASH_CHANGE="ROUTER/HASH_CHANGE",t.push=function(e){return{type:t.PUSH,payload:e}},t.hashChange=function(e){return{type:t.HASH_CHANGE,payload:e}}},function(e,t,r){"use strict";function n(e){return 0===e.indexOf("http")?e:"http://"+e}var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),s=r(1),a=function(e){function t(t){var r=e.call(this,t)||this;return r.state={searchTerm:r.props.filter},r.handleSearch=r.handleSearch.bind(r),r.handleSearchChange=r.handleSearchChange.bind(r),r}return i(t,e),t.prototype.render=function(){var e=this.tsx,t=this.props.base.applicationBaseResult.config,r=t.headerSearch?e("nav",{class:"class-top-nav-list right",role:"navigation",title:"usernav"},e("form",{class:"inline-block padding-leader-half",role:"search",onsubmit:this.handleSearch},e("input",{title:t.searchPlaceholder,type:"search",placeholder:t.searchPlaceholder,name:"q",value:this.state.searchTerm,style:"margin-top: -1px;",oninput:this.handleSearchChange}),e("button",{type:"submit",class:"hide"},t.searchPlaceholder))):null,i=t.headerSearch?e("nav",{class:"class-top-nav-list right",role:"navigation",title:"usernav"},e("form",{class:"inline-block padding-leader-half",role:"search",onsubmit:this.handleSearch},e("input",{title:t.searchPlaceholder,type:"search",placeholder:t.searchPlaceholder,name:"q",value:this.state.searchTerm,style:"margin-top: -1px;",oninput:this.handleSearchChange}),e("button",{type:"submit",class:"hide"},t.searchPlaceholder))):null,o=t.headerImage?e("img",{src:t.headerImageLocation,class:"header-image",alt:t.headerText}):null,s=t.showAgolLink?e("a",{class:"top-nav-link",href:n(t.agolLinkLocation.replace("${GROUP_ID}",t.group)),style:"color: "+t.headerTextColor,title:t.agolLinkText},t.agolLinkText):null;return e("header",{class:"top-nav fade-in",style:"background-color: "+t.headColor},e("div",{class:"grid-container"},e("div",{class:"column-24"},e("div",{class:"tablet-hide"},e("a",{href:n(t.headerTextURL)},o,e("a",{class:"top-nav-title",style:"color: "+t.headerTextColor},t.headerText)),r,s),e("div",{class:"tablet-show top-nav-flex"},e("header",{class:"top-nav-flex-title"},e("a",{href:n(t.headerTextURL)},e("a",{class:"top-nav-title",style:"color: "+t.headerTextColor},t.headerText)),i)))))},t.prototype.componentWillReceiveProps=function(e){e.filter!==this.state.searchTerm&&this.setState({searchTerm:e.filter})},t.prototype.handleSearch=function(e){e.preventDefault();var t=this.state.searchTerm.length>0?"query="+this.state.searchTerm:"";this.dispatch(s.push(""+t))},t.prototype.handleSearchChange=function(e){this.setState({searchTerm:e.target.value})},t}(o.default);t.default=a},function(e,t,r){"use strict";function n(e,t){return e.reduce(function(e,r){return e[e.length-1].length<t?e[e.length-1].push(r):e.push([r]),e},[[]])}var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(2),s=r(0),a=r(21),l=r(4),c=r(1),p=r(3),u=s.middlewares.addListener,d=function(e){function t(t){var r=e.call(this,t)||this,i=r.props.base.applicationBaseResult.config.itemsPerPage;return r.state={itemPages:n(r.props.items.filteredItems,i)},r.mapItemsToChildren=r.mapItemsToChildren.bind(r),r.handleChildUpdate=r.handleChildUpdate.bind(r),r.showInViewer=r.showInViewer.bind(r),r}return i(t,e),t.prototype.render=function(){var e=this.tsx;return this.props.viewer.fullscreen?null:e("div",{class:"grid-container leader-1"},e("div",{class:"column-24"},e("div",{class:"block-group block-group-5-up tablet-block-group-3-up phone-block-group-1-up"},this.mapItemsToChildren())))},t.prototype.shouldComponentUpdate=function(e){return e.items.displayKey!==this.props.items.displayKey},t.prototype.componentWillReceiveProps=function(e){if(e.items.displayKey!==this.props.items.displayKey){var t=this.props.base.applicationBaseResult.config.itemsPerPage;this.setState({itemPages:n(e.items.filteredItems,t)})}if(e.router.hash!==this.props.router.hash){var r=o.queryToObject(this.props.router.hash).viewer,i=o.queryToObject(e.router.hash).viewer;if(r!==i)for(var s in this.childComponents)this.childComponents.hasOwnProperty(s)&&this.childComponents[s].store.dispatch({type:l.VIEWER_CHANGE,payload:i})}},t.prototype.mapItemsToChildren=function(){var e=this,t=this.tsx,r=this.state.itemPages[this.props.page-1];return this.childComponents=r.reduce(function(t,r){return e.childComponents[r.id]&&(t[r.id]=e.childComponents[r.id]),t},{}),r.map(function(r){return"Dashboard"===r.type&&(r.url=r.portal.url+"/apps/opsdashboard/index.html#/"+r.id),t(a.default,{key:r.id,store:{reducers:a.reducers,initialState:{applicationBaseResult:e.props.base.applicationBaseResult,i18n:e.props.base.i18n,item:r,itemType:p.default[r.type]},middlewares:[u(e.handleChildUpdate)]}})})},t.prototype.handleChildUpdate=function(e,t){switch(e.type){case l.SHOW_IN_VIEWER:this.showInViewer(t.item.id);break;case l.SHOW_FULLSCREEN:this.showFullscreen(t.item.id)}},t.prototype.showInViewer=function(e){var t=this.props.router.hash,r=o.queryToObject(t);r.viewer=e,this.dispatch(c.push(o.objectToQuery(r)))},t.prototype.showFullscreen=function(e){var t=this.props.router.hash,r=o.queryToObject(t);r.viewer=e,r.fullscreen=!0,this.dispatch(c.push(o.objectToQuery(r)))},t}(s.default);t.default=d},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),o=r(22),s=r(4),a=r(23);t.reducers=a.reducers;var l=function(e){function t(t){var r=e.call(this,t)||this;return r.state={panelType:r.props.getPanelType(r.props.item.type)},r.handleMouseOver=r.handleMouseOver.bind(r),r.handleMouseOut=r.handleMouseOut.bind(r),r.handleItemKeyPress=r.handleItemKeyPress.bind(r),r.handleItemClick=r.handleItemClick.bind(r),r.handleMaxKeyPress=r.handleMaxKeyPress.bind(r),r.handleMaxClick=r.handleMaxClick.bind(r),r.registerItemLink=r.registerItemLink.bind(r),r}return n(t,e),t.prototype.render=function(){var e,t=this.tsx,r=this.props.i18n,n=this.props.applicationBaseResult.config,i=n.showAuthor?t("p",{class:"font-size--1 card-last hug-bottom author-text",key:this.props.item.title+"-author"},this.props.item.owner):null;n.showSummaryTooltip&&(e=this.props.item.snippet?this.props.item.snippet:null)&&e.length>n.tooltipTruncLength&&(e=e.slice(0,n.tooltipTruncLength)+"...");var s,a;n.showItemSummary&&(s=this.props.item.snippet?this.props.item.snippet:null,s&&s.length>n.summaryTruncLength&&(s=s.slice(0,n.summaryTruncLength)+"..."),a=t("p",{class:"item-description-text"},s));var l;n.showItemPageLink&&(l=t("a",{class:"open-out-icon btn btn-transparent toolbar-tooltip","aria-label":e||r.ui.itemExtTip,href:this.props.applicationBaseResult.portal.url+"/home/item.html?id="+this.props.item.id,style:"color: "+n.buttonBgColor,key:this.props.item.title+"-info-icon",tabindex:"0"},t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32",style:"\n                            fill: #0079c1;\n                            pointer-events: none;\n                            display: inline-block;\n                            width: 1em;\n                            height: 1em;\n                            vertical-align: -0.15em;\n                            padding-right: .15em;\n                        "},t("path",{d:"M31.297 16.047c0 8.428-6.826 15.25-15.25 15.25S.797 24.475.797 16.047c0-8.424 6.826-15.25 15.25-15.25s15.25 6.826 15.25 15.25zM18 24V12h-4v12h-2v2h8v-2h-2zm0-18h-4v4h4V6z"}))));var c;"file"===this.props.itemType||n.alwaysOpenFullscreen||(c=t("a",{class:"open-out-icon btn btn-transparent toolbar-tooltip","aria-label":r.ui[this.state.panelType+"ExtTip"],style:"color: "+n.buttonBgColor,key:this.props.item.title+"-open-out-icon",onclick:this.handleMaxClick,onkeypress:this.handleMaxKeyPress,tabindex:"0"},t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32",style:"\n                            fill: #0079c1;\n                            pointer-events: none;\n                            display: inline-block;\n                            width: 1em;\n                            height: 1em;\n                            vertical-align: -0.15em;\n                            padding-right: .15em;\n                        "},t("path",{d:"M2 4v24h28V4H2zm26 22H4V10h24v16z"}))));var p,u="file"===this.props.itemType?r.ui.itemExtTip:n.alwaysOpenFullscreen?r.ui[this.state.panelType+"ExtTip"]:r.ui.galleryTip;return n.showItemTitle&&(p=t("a",{title:u,style:"color: "+n.linkColor,class:"break-word"},t("h5",{tabindex:"0",class:"clickable"},this.props.item.title))),t("div",{class:"card block trailer-1 animate-fade-in card-fade",style:"background-color: "+n.cardColor+"; z-index: 1000",key:this.props.item.id+"-div"},t("figure",{class:"card-image-wrap"},t("a",{title:u,role:"link",tabindex:"0",onclick:this.handleItemClick,onkeypress:this.handleItemKeyPress,afterCreate:this.registerItemLink},t("img",{key:this.props.item.id+"-thumbnail",class:"card-image clickable thumbnail-min",src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",alt:this.props.item.title,onmouseover:this.handleMouseOver,onmouseout:this.handleMouseOut,style:"\n                                background-image: url("+this.props.item.thumbnailUrl+");\n                                background-repeat: no-repeat;\n                                background-size: cover;\n                            "})),t(o.default,{key:"card-caption"})),t("div",{class:"card-content",style:"color: "+n.fontColor},p,a,i,t("div",{class:"open-out-container"},l,c)))},t.prototype.componentWillReceiveProps=function(e){!e.activeViewer&&this.props.activeViewer&&this.state.itemLink&&this.props.activeViewer===this.props.item.id&&this.state.itemLink.focus()},t.prototype.registerItemLink=function(e){this.setState({itemLink:e})},t.prototype.handleMouseOver=function(){this.dispatch(s.mouseOver())},t.prototype.handleMouseOut=function(){this.dispatch(s.mouseOut())},t.prototype.handleItemKeyPress=function(e){"Enter"===e.key&&this.handleItemClick()},t.prototype.handleItemClick=function(){"file"===this.props.itemType?window.open(this.props.applicationBaseResult.portal.url+"/home/item.html?id="+this.props.item.id,"_blank"):this.props.applicationBaseResult.config.alwaysOpenFullscreen?this.handleMaxClick():this.dispatch(s.showInViewer())},t.prototype.handleMaxKeyPress=function(e){"Enter"===e.key&&this.handleMaxClick()},t.prototype.handleMaxClick=function(){this.props.applicationBaseResult.config.openFullscreenSeparateTab?"webapp"===this.props.itemType?window.open(this.props.item.url,"_blank"):window.open(""+window.location.origin+window.location.pathname+"?viewer="+this.props.item.id+"&fullscreen=true","_blank"):"webapp"===this.props.itemType?window.location.href=this.props.item.url:this.dispatch(s.showFullscreen())},t}(i.default);t.default=l},function(e,t,r){"use strict";function n(e,t){return e=e.replace("#",""),"rgba("+parseInt(e.substring(0,2),16)+","+parseInt(e.substring(2,4),16)+","+parseInt(e.substring(4,6),16)+","+t/100+")"}var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),s=function(e){function t(t){var r=e.call(this,t)||this;return r.state={captionBelowOpacity:.8,captionOpacity:1,captionTransform:0,panelType:r.props.getPanelType(r.props.item.type)},r}return i(t,e),t.prototype.render=function(){var e=this.tsx,t=this.props.applicationBaseResult.config;return t.showItemType?t.itemTypeBelowThumbnail?e("div",{class:"card-below-image-caption",style:"\n                            opacity: "+this.state.captionBelowOpacity+";\n                            background-color: "+n(t[this.state.panelType+"CaptionColor"],80)+";\n                            color: "+t.captionTextColor+";\n                        "},this.props.item.displayName):e("div",{class:"card-image-caption",style:"\n                            opacity: "+this.state.captionOpacity+";\n                            transform: translate(0, "+this.state.captionTransform+"%);\n                            background-color: "+n(t[this.state.panelType+"CaptionColor"],80)+";\n                            color: "+t.captionTextColor+";\n                        "},this.props.item.displayName):null},t.prototype.componentWillReceiveProps=function(e){e.hovering!==this.props.hovering&&this.setState({captionBelowOpacity:e.hovering?1:.8,captionOpacity:e.hovering?0:1,captionTransform:e.hovering?100:0})},t}(o.default);t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(4),o=function(e){return void 0===e&&(e={}),e},s=function(e){return void 0===e&&(e={}),e},a=function(e){return void 0===e&&(e={}),e},l=function(e){return void 0===e&&(e="file"),e},c=function(e){return void 0===e&&(e=function(e){var t={"Web Mapping Application":"app","Web Map":"map","Web Scene":"scene",Dashboard:"app"};return t[e]?t[e]:"file"}),e},p=function(e,t){switch(void 0===e&&(e=!1),t.type){case i.MOUSE_OVER:return!0;case i.MOUSE_OUT:return!1;default:return e}},u=function(e,t){switch(t.type){case i.VIEWER_CHANGE:return t.payload;default:return e}};t.reducers=n.combineReducers({applicationBaseResult:o,i18n:s,item:a,hovering:p,getPanelType:c,itemType:l,activeViewer:u})},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=r(2),o=r(0),s=r(1),a=r(25),l=r(32),c=r(3),p=function(e){function t(t){var r=e.call(this,t)||this;return r.state={containerClasses:{"animate-fade-in":!0,"animate-fade-out":!1},scrollY:0},r.handleExitKeyPress=r.handleExitKeyPress.bind(r),r.handleExitClick=r.handleExitClick.bind(r),r.closeViewer=r.closeViewer.bind(r),r}return n(t,e),t.prototype.render=function(){var e=this.tsx,t=this.props.base.i18n,r=this.props.base.applicationBaseResult.config,n=this.props.items.viewerItem;if(this.props.viewer.visible&&n.id){var i=c.default[n.type],o=void 0;if("webmap"===i)o=e(a.MapView,{key:n.id});else if("webscene"===i)o=e(a.SceneView,{key:n.id});else{if("webapp"!==i)return null;o=e(a.AppView,{key:n.id})}return this.props.viewer.fullscreen?e("div",{id:"map-container",class:"map-container fullscreen",key:"map-container-fullscreen-"+n.id},o):e("div",{id:"view-container",key:"view-container",classes:this.state.containerClasses,style:"background-color: "+l.default(r.bgColor,85)+";"},e("div",{id:"map-container",class:"map-container",key:"map-container-"+n.id},o,e("button",{class:"btn btn-clear view-exit-button clickable",onclick:this.handleExitClick,onkeypress:this.handleExitKeyPress,title:t.ui.close,afterCreate:this.focus},e("span",{class:"icon-ui-close view-exit-icon"}))))}return null},t.prototype.componentWillReceiveProps=function(e){!this.props.viewer.visible&&e.viewer.visible&&this.setState({scrollY:window.scrollY}),this.props.viewer.visible&&!e.viewer.visible&&(this.childComponents={})},t.prototype.focus=function(e){setTimeout(function(){e.focus()},10)},t.prototype.handleExitKeyPress=function(e){"Enter"===e.key&&this.handleExitClick()},t.prototype.handleExitClick=function(){var e=this;this.setState({containerClasses:{"animate-fade-in":!1,"animate-fade-out":!0}}),setTimeout(function(){e.closeViewer(),e.setState({containerClasses:{"animate-fade-in":!0,"animate-fade-out":!1}})},750)},t.prototype.closeViewer=function(){var e=this.props.router.hash,t=i.queryToObject(e);delete t.viewer,this.dispatch(s.push(i.objectToQuery(t)))},t}(o.default);t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(26);t.MapView=n.MapView;var i=r(30);t.AppView=i.AppView;var o=r(31);t.SceneView=o.SceneView},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=this&&this.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),s=r(6),a=function(e){function t(t){return e.call(this,t)||this}return n(t,e),t.prototype.render=function(){var e=this.tsx,t=this.props.base.applicationBaseResult.config;return e(s.default,{key:"map-view",store:{reducers:s.reducers,initialState:{config:t,i18n:this.props.base.i18n,id:this.props.items.viewerItem.id,widgets:Object.keys(t).filter(function(e){return-1!==e.indexOf("Widget")}).reduce(function(e,r){return i({},e,(n={},n[r]=t[r],n));var n},{}),viewModule:"esri/views/MapView",webModule:"esri/WebMap",containerId:"map-container"}}})},t}(o.default);t.MapView=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={config:{},i18n:{},id:"",widgets:{},viewModule:"",webModule:"",containerId:"map-container"};t.reducers=function(e,t){return void 0===e&&(e=n),e}},function(e,t){e.exports=a},function(e,t){e.exports=l},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),o=function(e){function t(t){return e.call(this,t)||this}return n(t,e),t.prototype.render=function(){var e=this.tsx;return e("iframe",{src:this.props.items.viewerItem.url,class:"app-frame",id:"embedded-mapping-application-iframe",name:"nested-iframe"},e("h3",{class:"center-style"},this.props.base.i18n.viewLoading.iframe))},t}(i.default);t.AppView=o},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=this&&this.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),s=r(6),a=function(e){function t(t){return e.call(this,t)||this}return n(t,e),t.prototype.render=function(){var e=this.tsx,t=this.props.base.applicationBaseResult.config;return e(s.default,{key:"map-view",store:{reducers:s.reducers,initialState:{config:t,i18n:this.props.base.i18n,id:this.props.items.viewerItem.id,widgets:Object.keys(t).filter(function(e){return-1!==e.indexOf("Widget")}).reduce(function(e,r){return i({},e,(n={},n[r]=t[r],n));var n},{}),viewModule:"esri/views/SceneView",webModule:"esri/WebScene",containerId:"map-container"}}})},t}(o.default);t.SceneView=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return e=e.replace("#",""),"rgba("+parseInt(e.substring(0,2),16)+","+parseInt(e.substring(2,4),16)+","+parseInt(e.substring(4,6),16)+","+t/100+")"}},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=r(2),o=r(0),s=r(1),a=function(e){function t(t){var r=e.call(this,t)||this;return r.handleNext=r.handleNext.bind(r),r.handlePrevious=r.handlePrevious.bind(r),r.handlePageButton=r.handlePageButton.bind(r),r.handlePage=r.handlePage.bind(r),r}return n(t,e),t.prototype.render=function(){var e=this,t=this.tsx,r=this.props.base.applicationBaseResult.config,n=this.props.items.filteredItems,i=Math.ceil(n.length/r.itemsPerPage),o={btn:!0,"btn-disabled":this.props.page<=1,"btn-transparent":!0},s={btn:!0,"btn-arrow":!0,"btn-disabled":this.props.page>=i,"btn-transparent":!0},a=Array.apply(null,Array(i)).map(function(n,i){var o=e.props.page===i+1;return t("a",{id:"page-"+(i+1)+"-button",title:"page-"+(i+1),class:"btn"+(o?"":" btn-transparent"),onclick:e.handlePageButton,role:"link",tabindex:"0",style:"\n                        color: "+(o?r.buttonTextColor:r.buttonBgColor)+";\n                        background-color: "+(o?r.buttonBgColor:null)+";\n                        border: "+(o?"1px solid "+r.buttonBgColor:"none")+"\n                    ",key:"page-button-"+(i+1)+"-"+e.props.items.displayKey},i+1)});return t("div",{class:"text-center trailer-1 leader-1",key:"pager"},t("a",{id:"previous",title:"previous",classes:o,role:"link",tabindex:"0",style:"color:"+r.buttonBgColor+";",key:"previous-button",onclick:this.handlePrevious},"Previous"),a,t("a",{id:"next",title:"next",classes:s,role:"link",tabindex:"0",style:"color:"+r.buttonBgColor+";",key:"next-button",onclick:this.handleNext},"Next"))},t.prototype.handleNext=function(){this.handlePage(this.props.page+1)},t.prototype.handlePrevious=function(){this.handlePage(this.props.page-1)},t.prototype.handlePageButton=function(e){this.handlePage(e.target.text)},t.prototype.handlePage=function(e){var t=this.props.router.hash,r=i.queryToObject(t);e>1?r.page=e:r.page&&delete r.page,this.dispatch(s.push(i.objectToQuery(r)))},t}(o.default);t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(35),o=r(36),s=r(37),a=r(38),l=r(39),c=r(40);t.reducers=n.combineReducers({base:i.default,items:o.default,router:s.default,filter:a.default,page:l.default,viewer:c.default})},function(e,t,r){"use strict";var n=this&&this.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(t,"__esModule",{value:!0});var i=r(1);t.default=function(e,t){switch(t.type){case i.SAVE_APP_BASE_RESULT:return n({},e,{loadMessage:"groupItems",applicationBaseResult:t.payload});case i.LOAD_APP_FAIL:return n({},e,{status:"failed"});case i.LOAD_APP_PROGRESS:return n({},e,{loadMessage:t.payload});case i.LOAD_APP_SUCCESS:return n({},e,{status:"success"});default:return e}}},function(e,t,r){"use strict";function n(e,t){return e.filter(function(e){return-1!==e.title.toLowerCase().indexOf(t)||-1!==e.type.toLowerCase().indexOf(t)||-1!==e.owner.toLowerCase().indexOf(t)||e.tags&&-1!==e.tags.map(function(e){return e.toLowerCase()}).indexOf(t)||e.description&&-1!==e.description.indexOf(t)||e.snippet&&-1!==e.snippet.indexOf(t)})}var i=this&&this.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(t,"__esModule",{value:!0});var o=r(2),s=r(1),a={allItems:[],filteredItems:[],displayKey:"",viewerItem:{}};t.default=function(e,t){switch(void 0===e&&(e=a),t.type){case s.UPDATE_ITEMS:return i({},e,{allItems:t.payload});case s.HASH_CHANGE:var r=o.queryToObject(t.payload);if(r.viewer){var l=e.allItems.filter(function(e){return e.id===r.viewer})[0];return i({},e,{viewerItem:l||{},filteredItems:n(e.allItems,r.query?r.query:""),displayKey:Math.random().toString(36).substring(7)})}return i({},e,{filteredItems:n(e.allItems,r.query?r.query:""),displayKey:Math.random().toString(36).substring(7)});default:return e}}},function(e,t,r){"use strict";var n=this&&this.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(t,"__esModule",{value:!0});var i=r(1),o={hash:""};t.default=function(e,t){switch(void 0===e&&(e=o),t.type){case i.HASH_CHANGE:return n({},e,{hash:t.payload});default:return e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(1);t.default=function(e,t){switch(void 0===e&&(e=""),t.type){case i.HASH_CHANGE:var r=n.queryToObject(t.payload);return r.query?r.query:"";default:return e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(1);t.default=function(e,t){switch(void 0===e&&(e=1),t.type){case i.HASH_CHANGE:var r=n.queryToObject(t.payload);return r.page?parseInt(r.page,10):1;default:return e}}},function(e,t,r){"use strict";var n=this&&this.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(t,"__esModule",{value:!0});var i=r(2),o=r(1),s={visible:!1,fullscreen:!1};t.default=function(e,t){switch(void 0===e&&(e=s),t.type){case o.HASH_CHANGE:var r=i.queryToObject(t.payload);return r.viewer?n({},e,{visible:!0,fullscreen:!!r.fullscreen}):n({},e,{visible:!1,fullscreen:!1});default:return e}}},function(e,t,r){"use strict";function n(e){e.dispatch(i.hashChange(window.location.hash.slice(1))),window.onhashchange=function(t){e.dispatch(i.hashChange(window.location.hash.slice(1)))}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(1);t.router=function(){return function(e){return function(t){switch(t.type){case i.PUSH:window.location.hash=t.payload;break;default:return e(t)}}}},t.startHistoryListener=n}])});
//# sourceMappingURL=application.js.map